 \documentclass{ujarticle}
 \usepackage{listings,jlisting}
 \renewcommand{\lstlistingname}{コード}
 \lstset{%
  language={C},
  basicstyle={\small},%
  identifierstyle={\small},%
  commentstyle={\small\itshape},%
  keywordstyle={\small\bfseries},%
  ndkeywordstyle={\small},%
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},%
  numbers=left,%
  xrightmargin=0zw,%
  xleftmargin=3zw,%
  numberstyle={\scriptsize},%
  stepnumber=1,
  numbersep=1zw,%
  lineskip=-0.5ex%
 }
 \pagestyle{empty}
 \begin{document}

以下のソースコードを作成した．
\lstinputlisting[caption=ソースコード]{calccg.c}
続いて，ccを-oで出力先を指定して実行した．
\lstinputlisting[caption=コンパイル,language=]{calccg.comp}
最後に実行し，結果を得た．
\lstinputlisting[caption=実行結果,language=]{calccg.txt}
\end{document}